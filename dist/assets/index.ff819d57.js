var I=Object.defineProperty,B=Object.defineProperties;var m=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var d=(i,o,e)=>o in i?I(i,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[o]=e,c=(i,o)=>{for(var e in o||(o={}))Q.call(o,e)&&d(i,e,o[e]);if(g)for(var e of g(o))S.call(o,e)&&d(i,e,o[e]);return i},h=(i,o)=>B(i,m(o));import{l as M}from"./vendor.5ac9174a.js";const k=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))t(P);new MutationObserver(P=>{for(const r of P)if(r.type==="childList")for(const A of r.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&t(A)}).observe(document,{childList:!0,subtree:!0});function e(P){const r={};return P.integrity&&(r.integrity=P.integrity),P.referrerpolicy&&(r.referrerPolicy=P.referrerpolicy),P.crossorigin==="use-credentials"?r.credentials="include":P.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(P){if(P.ep)return;P.ep=!0;const r=e(P);fetch(P.href,r)}};k();var T="data:image/png;base64,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",p="/assets/square-blue.cf3d0ebe.png";const D={red:T,blue:p},l=["red","blue"],G=()=>l[Math.floor(Math.random()*l.length)],u=()=>{const i=w[Math.floor(Math.random()*w.length)];return new y(i,G(),!1)},a={width:300,height:550},C={width:100,height:100},s=25,w=["IPiece","JPiece","LPiece","OPiece","SPiece","TPiece","ZPiece"];class f{constructor(o,e,t){this.xPos=o,this.yPos=e,this.image=new Image,this.image.src=D[t]}draw(o){o.drawImage(this.image,this.xPos,this.yPos,s,s)}}const J={IPiece:[[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s*2,yPos:s},{xPos:s*3,yPos:s}],[{xPos:s*2,yPos:0},{xPos:s*2,yPos:s},{xPos:s*2,yPos:s*2},{xPos:s*2,yPos:s*3}],[{xPos:0,yPos:s*2},{xPos:s,yPos:s*2},{xPos:s*2,yPos:s*2},{xPos:s*3,yPos:s*2}],[{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s,yPos:s*3}]],JPiece:[[{xPos:0,yPos:0},{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s*2,yPos:s}],[{xPos:s,yPos:0},{xPos:s*2,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2}],[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s*2,yPos:s},{xPos:s*2,yPos:s*2}],[{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:0,yPos:s*2}]],LPiece:[[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s*2,yPos:s},{xPos:s*2,yPos:0}],[{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s*2,yPos:s*2}],[{xPos:0,yPos:s},{xPos:0,yPos:s*2},{xPos:s,yPos:s},{xPos:s*2,yPos:s}],[{xPos:0,yPos:0},{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2}]],OPiece:[[{xPos:s,yPos:0},{xPos:s*2,yPos:0},{xPos:s,yPos:s},{xPos:s*2,yPos:s}]],SPiece:[[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s,yPos:0},{xPos:s*2,yPos:0}],[{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s*2,yPos:s},{xPos:s*2,yPos:s*2}],[{xPos:0,yPos:s*2},{xPos:s,yPos:s*2},{xPos:s,yPos:s},{xPos:s*2,yPos:s}],[{xPos:0,yPos:0},{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s,yPos:s*2}]],TPiece:[[{xPos:0,yPos:s},{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s*2,yPos:s}],[{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s*2,yPos:s}],[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s*2,yPos:s}],[{xPos:0,yPos:s},{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s,yPos:s*2}]],ZPiece:[[{xPos:0,yPos:0},{xPos:s,yPos:0},{xPos:s,yPos:s},{xPos:s*2,yPos:s}],[{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s*2,yPos:0},{xPos:s*2,yPos:s}],[{xPos:0,yPos:s},{xPos:s,yPos:s},{xPos:s,yPos:s*2},{xPos:s*2,yPos:s*2}],[{xPos:0,yPos:s},{xPos:0,yPos:s*2},{xPos:s,yPos:0},{xPos:s,yPos:s}]]};class y{constructor(o,e,t){this.type=o,this.colour=e,this.orientations=M.exports.cloneDeep(J[o]).map(P=>P.map(r=>{const A=t?r.xPos:r.xPos+100;return new f(A,r.yPos,this.colour)})),this.orientationIndex=0,this.squares=this.orientations[this.orientationIndex]}getNextOrientationIndex(){return this.orientationIndex+1<this.orientations.length?this.orientationIndex+1:0}draw(o){this.squares.forEach(e=>e.draw(o))}}class O{constructor(o,e,t){this.forbiddenSquares=[],this.currentPiece=o,this.queuedPiece=void 0,this.mainCtx=e,this.extraInfoCtx=t,this.messages=[""]}update(o){if(o==="up"){const e=this.currentPiece.getNextOrientationIndex(),t=this.currentPiece.orientations[e];if(this.checkOutOfBounds(t))return;this.currentPiece.orientationIndex=e,this.currentPiece.squares=t}if(o==="down"){const e=this.currentPiece.squares.map(t=>({xPos:t.xPos,yPos:t.yPos+s}));if(this.checkOutOfBounds(e)){const t=this.currentPiece.squares.map(r=>new f(r.xPos,r.yPos,this.currentPiece.colour));this.forbiddenSquares.push(...t);const P=u();this.currentPiece=P;return}this.currentPiece.orientations.forEach(t=>{t.forEach(P=>P.yPos+=s)})}if(o==="left"){const e=this.currentPiece.squares.map(t=>h(c({},t),{xPos:t.xPos-s}));if(this.checkOutOfBounds(e))return;this.currentPiece.orientations.forEach(t=>{t.forEach(P=>P.xPos-=s)})}if(o==="right"){const e=this.currentPiece.squares.map(t=>h(c({},t),{xPos:t.xPos+s}));if(this.checkOutOfBounds(e))return;this.currentPiece.orientations.forEach(t=>{t.forEach(P=>P.xPos+=s)})}}queuePiece(){if(this.queuedPiece){const o=new y(this.queuedPiece.type,this.queuedPiece.colour,!1);this.queuedPiece=new y(this.currentPiece.type,this.currentPiece.colour,!0),this.currentPiece=o}else this.queuedPiece=new y(this.currentPiece.type,this.currentPiece.colour,!0),this.currentPiece=u()}dropPiece(){let o=!0;for(;o;){const e=this.currentPiece.squares.map(t=>h(c({},t),{yPos:t.yPos+s}));if(this.checkOutOfBounds(e)){o=!1;return}this.currentPiece.orientations.forEach(t=>{t.forEach(P=>P.yPos+=s)})}}checkForLineClear(){for(let o=0;o<a.height;o++){const e=this.forbiddenSquares.filter(t=>t.yPos===o*s);e.length===a.width/25&&(this.messages.push("Line clear!"),e.forEach(t=>{this.forbiddenSquares.splice(this.forbiddenSquares.indexOf(t),1)}),this.forbiddenSquares.forEach(t=>{t.yPos<o*s&&(t.yPos+=s)}))}}checkGameOver(){return!!this.currentPiece.squares.find(o=>this.forbiddenSquares.find(e=>o.xPos===e.xPos&&o.yPos===e.yPos))}checkOutOfBounds(o){return o.find(e=>e.yPos>525||e.yPos<0||e.xPos<0||e.xPos>275||this.forbiddenSquares.find(t=>t.yPos===e.yPos&&t.xPos===e.xPos))}draw(){var e,t,P;this.mainCtx.fillStyle="White",this.mainCtx.fillRect(0,0,a.width,a.height),this.extraInfoCtx.fillStyle="White",this.extraInfoCtx.fillRect(0,0,C.width,C.height),this.mainCtx.strokeStyle="LightGray";for(let r=0;r<300;r+=s)for(let A=0;A<550;A+=s)this.mainCtx.strokeRect(r,A,s,s);this.extraInfoCtx.strokeStyle="LightGray";for(let r=0;r<100;r+=s)for(let A=0;A<100;A+=s)this.extraInfoCtx.strokeRect(r,A,s,s);const o=document.getElementById("gameMessages");o&&(o.innerHTML=(e=this.messages)==null?void 0:e.reduce((r,A)=>`${r}${A}<br>`,`Game speed: ${1}<br>Game messages:<br>`)),(t=this.currentPiece)==null||t.draw(this.mainCtx),(P=this.queuedPiece)==null||P.draw(this.extraInfoCtx),this.forbiddenSquares.forEach(r=>r.draw(this.mainCtx))}}const R=(i,o)=>{i.code==="ArrowDown"||i.code==="KeyS"?o.update("down"):i.code==="ArrowLeft"||i.code==="KeyA"?o.update("left"):i.code==="ArrowRight"||i.code==="KeyD"?o.update("right"):i.code==="ArrowUp"||i.code==="KeyW"?o.update("up"):i.code==="KeyQ"?o.queuePiece():i.code==="Space"&&o.dropPiece()};let x=0,L=1e3,n;addEventListener("load",()=>{const i=document.getElementById("mainCanvas"),o=document.getElementById("extraInfoCanvas"),e=i.getContext("2d"),t=o.getContext("2d");document.onkeydown=P=>R(P,n),n=new O(u(),e,t),requestAnimationFrame(E)});const E=i=>{x||(x=i);let o=i-x,e=!1;o>L&&(n.update("down"),n.checkForLineClear(),e=n.checkGameOver(),console.log(e),x=i,o=0),e||requestAnimationFrame(E),n.draw()};
